````markdown
## Threat Intel Aggregator

---

## Overview

The Threat Intel Aggregator is a comprehensive Python-based cybersecurity project designed to collect, process, visualize, and alert on threat intelligence data in real-time. It aggregates Indicators of Compromise (IOCs) from multiple sources, including AlienVault, FeodoTracker, and AbuseIPDB, deduplicates them, geolocates IPs, generates interactive maps, and sends Slack and email alerts for new indicators.  

This project integrates automated SAST scanning using Bandit, Safety, and Pip-Audit, allowing security-focused analysis of both the aggregator itself and its dependencies.

---

## Features

- Threat Intelligence Aggregation
  - Fetches IOCs (IP addresses, domains) from multiple sources.
  - Deduplicates and cleans data before saving.
  
- Geolocation
  - Determines country, latitude, and longitude of IPs.
  - Produces real-time terminal progress logs.
  
- Visualization
  - Generates an interactive heatmap highlighting the top 10 countries with detected malicious IPs.
  - Map saved in `visuals/threat_map_top10.html`.

- Alerts
  - Sends summary alerts to Slack channels.
  - Sends email alerts for new indicators via Gmail.

- Automated Security Scans (SAST)
  - Uses Bandit for Python code analysis.
  - Uses Safety to check Python dependencies for known vulnerabilities.
  - Uses Pip-Audit for auditing installed packages.

- Logging
  - All runs logged in the `logs/` folder.
  - Timestamped logs for each execution.

````
## Demo

Below is a screenshot of the threat map generated by the aggregator:

![Threat Map](https://github.com/KoredeSec/threat-intel-aggregator/blob/main/visuals/threat_map_top10.png)

## Installation

1. **Clone the repository**

```bash
git clone https://github.com/YOUR_USERNAME/threat-intel-aggregator.git
cd threat-intel-aggregator
```

2. **Create and activate a virtual environment**

```bash
python3 -m venv threat-intel
source threat-intel/bin/activate
```

3. **Install dependencies**

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

---

## Configuration

1. **Environment variables**

Create a `.env` file in the project root:

```bash
OTX_KEY=your_alienvault_api_key
ABUSEIPDB_KEY=your_abuseipdb_api_key
EMAIL_USER=your_email@gmail.com
EMAIL_PASS=your_email_password
SLACK_WEBHOOK=https://hooks.slack.com/services/...
```

> **Note:** Slack and email alerts are optional. If no keys are provided, the aggregator will skip those steps.

2. **Optional Scheduler**

The aggregator can be scheduled to run daily at a specific UTC hour:

```python
# Uncomment in threat_aggregator.py
# schedule_daily("09:00")
```

---

## Usage

Run the aggregator manually:

```bash
python3 threat_aggregator.py
```

* Outputs are saved in `threat_feed.csv`.
* Visual maps are saved in `visuals/threat_map_top10.html`.
* Logs are saved in `logs/`.

---

## SAST Scanning

You can scan the project using the integrated Bash script:

```bash
./run_sast.sh
```

* **Bandit:** Scans all Python files in the project.
* **Safety:** Checks dependencies for known vulnerabilities.
* **Pip-Audit:** Audits installed packages for known security issues.

---

## Project Structure

```
threat-intel-aggregator/
├── threat_aggregator.py       # Main aggregator script
├── requirements.txt           # Python dependencies
├── .gitignore                 # Files/folders to ignore in Git(.env)
├── run_sast.sh                # SAST automation script
├── visuals/                   # Output maps, screenshots
│   └── threat_map_top10.html
│   └── threat_map_top10.png
├── sast_reports/
│   └──bandit_report.html
│   └──safety_report.json
│   └──pip_audit_report.json
├── threat_feed.csv	       # Output CSV of aggregated indicators
├── logs/                      # Execution logs
└── README.md                  # Project description and instructions
```

---

## Contribution

1. Fork the repository.
2. Create a feature branch: `git checkout -b feature/my-feature`.
3. Commit your changes: `git commit -m 'Add my feature'`.
4. Push to branch: `git push origin feature/my-feature`.
5. Open a Pull Request.

---

## License

This project is licensed under the **MIT License**. See the [LICENSE](LICENSE) file for details.

---

## References

* [AlienVault OTX API](https://otx.alienvault.com/api/)
* [FeodoTracker IP Blocklist](https://feodotracker.abuse.ch/)
* [AbuseIPDB API](https://www.abuseipdb.com/)
* [Bandit - Python SAST](https://bandit.readthedocs.io/)
* [Safety - Python Dependency Checking](https://pyup.io/safety/)
* [Pip-Audit](https://pypi.org/project/pip-audit/)

```
## Author
**Ibrahim Yusuf**  
Cybersecurity Student | NACSS_UNIOSUN President | Cybersecurity and Cloud Enthusiast
